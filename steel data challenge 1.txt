#1. What are the details of all cars purchased in the year 2022?
select *
from cars inner join sales using(car_id)
where purchase_date= 2022;

#2. What is the total number of cars sold by each salesperson?
select name, count(car_id) as total_cars_sold
from salespersons inner join sales using(salesman_id) inner join cars using(car_id)
group by 1;

#3. What is the total revenue generated by each salesperson?
select name, sum(cost_$) as total_revenue
from salespersons inner join sales using(salesman_id) inner join cars using(car_id)
group by 1;

#4. What are the details of the cars sold by each salesperson?
select salesman_id,name,car_id, make, type, style, cost_$
from sales inner join salespersons using(salesman_id) inner join cars using(car_id)
order by 1;

#5. What is the total revenue generated by each car type?
select type, sum(cost_$) as revenue
from cars 
group by 1;

#6. What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?
select car_id, make, type, style, cost_$
from cars inner join sales using(car_id) inner join salespersons using(salesman_id)
where name ="Emily Wong" and year(purchase_date) =2021;

#7. What is the total revenue generated by the sales of hatchback cars?
select sum(cost_$) as revenue
from cars inner join sales using(car_id)
where style = "hatchback";

#8. What is the total revenue generated by the sales of SUV cars in the year 2022?
select sum(cost_$) as revenue 
from cars inner join sales using(car_id)
where style= "SUV" and year(purchase_date)= 2022;

#9. What is the name and city of the salesperson who sold the most number of cars in the year 2023?
select name, city , count(car_id) as cars_sold
from sales inner join salespersons using(salesman_id)
where year(purchase_date)=2023
group by 1,2
order by 3 desc
limit 1;

#10. What is the name and age of the salesperson who generated the highest revenue in the year 2022?
select name, city , sum(cost_$) as revenue
from sales inner join salespersons using(salesman_id) inner join cars using(car_id)
where year(purchase_date)=2022
group by 1,2
order by 3 desc
limit 1;